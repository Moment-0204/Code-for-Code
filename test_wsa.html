<html>
<head>
    <meta charset="UTF-8" />
    <title>Web Speech API</title>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script>
        window.SpeechRecognition = window.SpeechRecognition || webkitSpeechRecognition;
        var recognition = new webkitSpeechRecognition();
        recognition.lang = 'ja';
        recognition.interimResults = true;

        // 録音終了時トリガー
        recognition.addEventListener('result', function(event){
            var text = event.results.item(0).item(0).transcript;
            $("#result_text").val(text);
        }, false);

        // 録音開始
        function record()
        {
            recognition.start();
        }

        function sea() {
            var data=[
                ["暗号","暗号同好会 4A教室前半","高校棟3階　4年A組　まえ半分"],
                ["工作","電子工作部 6C教室","高校棟1階　6年C組"]
            ];
            var test=document.getElementById("result_text").value;
            document.getElementById("out").value="1";
            var outt="見つかりません";
            for(var i=0;i<data.length;i++){
                if(test.indexOf(data[i][0])!==-1){
                    outt=data[i][2];
                    document.getElementById("out").value=data[i][1];
                }
            }

            // 発話機能をインスタンス化
            var msg = new SpeechSynthesisUtterance();
            //var voices = window.speechSynthesis.getVoices();

            // 以下オプション設定（日本語は効かないもよう。。）
            //msg.voice = voices[7]; // 7:Google 日本人 ja-JP ※他は英語のみ（次項参照）
            msg.volume = 1.0; // 音量 min 0 ~ max 1
            msg.rate = 1.0; // 速度 min 0 ~ max 10
            msg.pitch = 1.0; // 音程 min 0 ~ max 2

            msg.text = outt; // 喋る内容
            msg.lang = 'ja-JP'; // en-US or ja-JP
            // msg.lang = 'en-US'; // en-US or ja-JP

            // 発話実行
            speechSynthesis.speak(msg);
            //msg.onend = function(event) {
            //    alert('Finished in ' + event.elapsedTime + ' seconds.');
            //};
        }
    </script>
</head>

<body>
<h1 style="text-align: center">test page</h1>
<center>
<input id="result_text" type="text" size="18" maxlength="10">
<input type="button" onClick="record()" value="入力" />
<br>
<input type="button" onclick="sea()" value="検索">
<br>
<input id="out" type="text">
</center>
</body>
</html>