<html>
<head>
    <meta charset="UTF-8">
    <title>TAC open cup 1st</title>
<style type="text/css">
    body{
        background-color:white ;
    }
    textarea{
        width:100%;
    }
    /* 表示領域全体 */
    div.tabbox {
        margin: 0px; padding: 0px;
    }

    /* タブ部分 */
    p.tabs { margin: 0px; padding: 0px; }
    p.tabs a {
        display: block; width: 5em; float: left;
        margin: 0px 1px 0px 0px; padding: 3px;
        text-align: center;
        border-radius: 12px 12px 0px 0px; /* 角を丸くする */
    }
    p.tabs a.tab1 { background-color: red; color: black; }
    p.tabs a.tab2 { background-color: orange; color:black;}
    p.tabs a.tab3 { background-color: yellow; color: black; }
    p.tabs a.tab4 { background-color: green; color: black;}
    p.tabs a.tab5 { background-color: lightblue; color: black;}
    p.tabs a.tab6 { background-color: blue; color: black;}
    p.tabs a.tab7 { background-color: violet; color: black;}
    p.tabs a:hover { color: white; }

    /* タブ中身のボックス */
    div.tab {  overflow: auto; clear: left; }
    div#tab1 {
        border: 2px solid red; background-color: white;
    }
    div#tab2 {
        border: 2px solid orange; background-color: white;
    }
    div#tab7 iframe{
        width: 100%;
    }
    div#tab3 {
        border: 2px solid yellow; background-color: white;
    }
    div#tab4 {
        border: 2px solid green; background-color: white;
    }
    div#tab5 {
        border: 2px solid lightblue; background-color: white;
    }
    div#tab6 {
        border: 2px solid blue; background-color: white;
    }
    div#tab7 {
        border: 2px solid violet; background-color: white;
    }
    div.tab p { margin: 0.5em; }
</style>
<script type="text/javascript">
    function ChangeTab(tabname) {
        // 全部消す
        document.getElementById('tab1').style.display = 'none';
        document.getElementById('tab2').style.display = 'none';
        document.getElementById('tab3').style.display = 'none';
        document.getElementById('tab4').style.display = 'none';
        document.getElementById('tab5').style.display = 'none';
        document.getElementById('tab6').style.display = 'none';
        document.getElementById('tab7').style.display = 'none';
        // 指定箇所のみ表示
        document.getElementById(tabname).style.display = 'block';
        if(tabname==='tab7')sta();
    }

    function sta(){
        var table=document.getElementById("sta");
        var num=table.rows.length;
        if(num>1)for(var i=1; i<num; i++)table.deleteRow(1);
        var url = 'https://script.google.com/macros/s/AKfycbwk9HbcvIjCKwSY_7j9F3EgYWYXAySi3zar9hXaO3cknCdC2vJC/exec'; //遅延情報のJSON
        fetch(url)
            .then(function (data) {
                return data.json(); // 読み込むデータをJSONに設定
            })
            .then(function (json) {
                for (var i = 0; i < json.length; i++) {
                    var row = document.getElementById('sta').insertRow();
                    var cell=row.insertCell();cell.textContent = json[i].Rank;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].Participant;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].A;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].B;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].C;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].D;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].E;cell.style.textAlign="center";
                    cell=row.insertCell();cell.textContent = json[i].Point;cell.style.textAlign="center";
                }
            });
    }
</script>
</head>
<body>
<div style="font-size:300%; text-align:center;">TAC opencup 1st</div>
<div class="tabbox">
    <p class="tabs">
        <a href="#tab1" class="tab1" onclick="ChangeTab('tab1'); return false;">TOP</a>
        <a href="#tab2" class="tab2" onclick="ChangeTab('tab2'); return false;">A</a>
        <a href="#tab3" class="tab3" onclick="ChangeTab('tab3'); return false;">B</a>
        <a href="#tab4" class="tab4" onclick="ChangeTab('tab4'); return false;">C</a>
        <a href="#tab4" class="tab5" onclick="ChangeTab('tab5'); return false;">D</a>
        <a href="#tab4" class="tab6" onclick="ChangeTab('tab6'); return false;">E</a>
        <a href="#tab4" class="tab7" onclick="ChangeTab('tab7'); return false;">standing</a>
    </p>
    <div id="tab1" class="tab">
        <font size="5">
            TAC opencup 1stへようこそ！<br>
            問題は全部で5問です。制限時間は100分です。<br>
            配点は100-100-200-300-400-800(部分点:0-800)です。<br>
            ルール:<br>
            各問題の暗号方式は明らかにされませんが、問題の点数と難易度にはある程度の相関があります。<br>
            問題に正解する度にその問題の点数が加算されます。順位は総合点数→解答にかかった時間の順で決定されます。解答にかかった時間は(最後に正解した問題を解いた時間)+(不正解によるペナルティ:回数×5分)で計算されます(つまり、AtCoderと同じです)。<br>
            提出する度に正解・不正解が判定され(実際とは違う気もしますが……)、順位表にその結果が表示されます：正解→点数が表示、不正解→ペナルティ数のみが表示。<br>
            順位表の元URL:<a href="https://docs.google.com/spreadsheets/d/1JmaWEHwi_0PXRC4wMjf8M0eDvPiYWCURycQv6XAcirg/edit?usp=sharing"target="_blank" rel="noopener noreferrer">https://docs.google.com/spreadsheets/d/1JmaWEHwi_0PXRC4wMjf8M0eDvPiYWCURycQv6XAcirg/edit?usp=sharing</a>
        </font>
    </div>
    <div id="tab2" class="tab">
        <form action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSeauEO1Sxd7Z9yK4fnd6j7zeCYRV-EoNbemjr6BVFPJPZ6_oQ/formResponse" method="post" target="hidden_iframe" onsubmit="submitted=true;">
            <dir>
                <label>解答</label>
                <input id="name" type="text" name="entry.875776795" required="required">
                <button type="submit" name="button">送信</button>
            </dir>
        </form>
    </div>
    <div id="tab3" class="tab">
        <p>
        <h1>入力</h1>
        <form action="">
            <center>
                <textarea id="msin" rows="10"></textarea>
            </center><br>
            <center>
                <b>鍵</b>
                <textarea id="mskey" rows="1"></textarea>
                <input type="radio" name="mssel" id="mse" checked="true">暗号化
                <input type="radio" name="mssel">復号化
            </center>
            <center>
                <input type="radio" name="mscs" id="msc" checked="true">number
                <input type="radio" name="mscs" >strange char
                <b>文字起点</b>
                <input id="msch" type="text" size="18" maxlength="10">
                <br>
                <p>recommend:700,1000,14000,107400</p>
            </center>
            <center>
                <button onclick="Ms(); return false;">送信</button>
            </center>
        </form>
        </p>
        <hr>
        <h1>出力</h1>
        <center>
            <textarea id="msout" rows="10"></textarea>
        </center>
    </div>
    <div id="tab4" class="tab">
        <iframe width="600" height="400" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRLfeGACKD53NYTjV8FwoikOFA0ohlW42qu3C4dX3v0Jewi1vLS5lkRIXzL6ro-QXho0rg8xJtXGdyf/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>
    <div id="tab5" class="tab">
        <iframe width="600" height="400" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRLfeGACKD53NYTjV8FwoikOFA0ohlW42qu3C4dX3v0Jewi1vLS5lkRIXzL6ro-QXho0rg8xJtXGdyf/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>
    <div id="tab6" class="tab">
        <iframe width="600" height="400" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRLfeGACKD53NYTjV8FwoikOFA0ohlW42qu3C4dX3v0Jewi1vLS5lkRIXzL6ro-QXho0rg8xJtXGdyf/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
    </div>
    <div id="tab7" class="tab">
        <table border width="100%" id="sta">
            <tr align="center">
                <th>Rank</th>
                <th>Participant</th>
                <th>A</th>
                <th>B</th>
                <th>C</th>
                <th>D</th>
                <th>E</th>
                <th>Point</th>
            </tr>
        </table>
        <button onclick="ChangeTab('tab7'); return false;">リロード(毎回する必要あり)</button>
    </div>
</div>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted){ChangeTab('tab7'); return false;}"></iframe>
<script type="text/javascript">
    // デフォルトのタブを選択
    ChangeTab('tab1');
</script>
</body>
</html>
